Sub GetRealEstate()    'Ask user to choose a city and a budget    city = InputBox("What city would you like to live in (case sensitive)?")    lim = InputBox("What is your budget (USD)? Leave out commas, decimals, and dollar signs")        Worksheets("realtor-dataset-100k").Activate        'Parameter tracking location of matches    matchIndex = 2        'Parameters tracking beginning and end of housing information    RowStart = 2    RowEnd = Cells(Rows.Count, "A").End(xlUp).Row        'Compare each estate to the requirements of the user    For i = RowStart To RowEnd                'Check to make sure the estate is within the budget, in the right city and is for sale        If Cells(i, 2).Value <= CLng(lim) And Cells(i, 8).Value = city And Cells(i, 1) = "for_sale" Then                        'Store estate information from dataset            Address = Cells(i, 6).Value            Price = Cells(i, 2).Value            Bed = Cells(i, 3).Value            Bath = Cells(i, 4).Value            House_size = Cells(i, 11).Value                        Worksheets("Results").Activate                        'Add estate information to Results worksheet            Cells(matchIndex, 1).Value = Address            Cells(matchIndex, 2).Value = Price            Cells(matchIndex, 3).Value = Bed            Cells(matchIndex, 4).Value = Bath            Cells(matchIndex, 5).Value = House_size                        Worksheets("realtor-dataset-100k").Activate                        'Add to index to determine where estate information will be stored            matchIndex = matchIndex + 1                    End If    Next i        'Notify user if there are no matches    If matchIndex = 2 Then        MsgBox ("We are sorry, but there seems to be no matches. Please try another city or adjust the budget.")            Else        Worksheets("Results").Activate                'Add Headers        Cells(1, 1).Value = "Address"        Cells(1, 2).Value = "Price (USD)"        Cells(1, 3).Value = "Bed"        Cells(1, 4).Value = "Bath"        Cells(1, 5).Value = "House Size (Square Feet)"                'Basic Formating        Worksheets("Results").Columns("A:E").AutoFit        Range("B2:B2000").NumberFormat = "#,##0"                MsgBox ("All done! Look in the Results sheet for estates matching your requirements.")            End If    End SubSub ClearResults()    Worksheets("Results").Activate    Cells.ClearEnd SubSub SortPriceLowToHigh()        Worksheets("Results").Activate        'Code source: https://stackoverflow.com/questions/21451458/vba-excel-sort-range-by-specific-column    Dim lastrow As Long    lastrow = Cells(Rows.Count, 2).End(xlUp).Row    Range("A2:E" & lastrow).Sort key1:=Range("B2:B" & lastrow), _        order1:=xlAscending, Header:=xlNo        End SubSub SortPriceHighToLow()    Worksheets("Results").Activate        'Code source: https://stackoverflow.com/questions/21451458/vba-excel-sort-range-by-specific-column    Dim lastrow As Long    lastrow = Cells(Rows.Count, 2).End(xlUp).Row    Range("A2:E" & lastrow).Sort key1:=Range("B2:B" & lastrow), _        order1:=xlDescending, Header:=xlNo    End Sub